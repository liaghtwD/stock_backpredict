# 市场周期分段回测分析报告

## 1. 分析目标

将整个回测时间段按市场周期（牛市、熊市、震荡市）划分,测试两种策略（中长期和短期）在不同市场环境下的表现稳定性,分析:
- 哪些时期主要贡献了策略收益
- 不同市场环境下的风险特征差异
- 策略在各类市场的适应性

## 2. 数据来源

### 市场周期标注
- **数据文件**: `condition.csv`
- **标注维度**:
  - `day`: 交易日期
  - `market`: 市场指数
  - `market_return`: 日收益率
  - `market_condition`: 市场状态 (bull/bear/consolidation)

### 周期分布统计
在整个数据集中(2013-12-02 ~ 2025-11-27, 共2915个交易日):
- **震荡市 (consolidation)**: 2160天 (74.1%)
- **牛市 (bull)**: 477天 (16.4%)
- **熊市 (bear)**: 278天 (9.5%)

## 3. 回测期间市场周期划分

### 分析期间
**2024-02-05 ~ 2025-09-30** (共401个交易日)

### 周期段识别结果

#### 震荡市阶段
- **时间范围**: 2024-02-05 ~ 2024-09-26
- **交易天数**: 155天
- **平均日收益**: 0.0573%
- **累计市场收益**: **+8.64%**
- **市场特征**: 宽幅震荡,无明显趋势,适合区间交易策略

#### 牛市阶段  
- **时间范围**: 2024-09-27 ~ 2025-09-30
- **交易天数**: 246天
- **平均日收益**: 0.1113%
- **累计市场收益**: **+29.97%**
- **市场特征**: 持续上涨趋势,适合趋势跟踪策略

### 关键发现
⚠️ **注意**: 回测期间**未出现熊市周期**,这意味着:
1. 策略在下跌市场的表现尚未得到验证
2. 当前回测结果可能高估了策略的整体稳健性
3. 需要在未来熊市期间持续监控策略表现

## 4. 策略表现分析框架

### 中长期策略 (GA优化参数)
- **策略类型**: 基于深度学习模型的三分类预测 + 遗传算法优化阈值
- **数据准备**: 
  - 使用 60 天窗口数据
  - 预测未来 20 天走势(强/中/弱)
  - 针对 14 个行业板块分别优化参数
  
### 短期策略 (Logistic回归)
- **策略类型**: 基于逻辑回归的短期交易信号
- **数据准备**:
  - 使用 5 天窗口数据
  - 预测未来 5 天内 +4% 上涨机会
  - 每只股票独立训练模型

## 5. 预期分析维度

### 收益贡献分析
```
问题: 策略的主要收益来自哪个市场周期?
- 震荡市期间的累计收益占比
- 牛市期间的累计收益占比
- 各周期的年化收益率对比
```

### 风险特征对比
```
问题: 不同市场环境下的风险暴露如何?
- 震荡市最大回撤 vs 牛市最大回撤
- 夏普比率在不同周期的变化
- 胜率和盈亏比的波动
```

### 策略适应性
```
问题: 两种策略分别适合什么市场?
- 中长期策略: 趋势市 vs 震荡市
- 短期策略: 高波动 vs 低波动
- 不同周期下的交易频率变化
```

## 6. 工具脚本说明

### 快速市场周期统计
```bash
python quick_regime_analysis.py
```
- **功能**: 统计回测期间各市场周期的基本特征
- **输出**: `regime_analysis_results/market_regime_summary.csv`

### 完整分段回测 (开发中)
```bash
python backtest_by_market_regime.py
```
- **功能**: 
  - 加载中长期策略(GA参数)和短期策略模型
  - 按市场周期分段运行回测
  - 计算每个周期的策略表现指标
  - 生成对比分析报告

- **预期输出**:
  - `regime_analysis_longterm.csv`: 中长期策略各周期表现
  - `regime_analysis_shortterm.csv`: 短期策略各周期表现  
  - `regime_comparison.csv`: 两种策略对比

## 7. 当前进展

### ✅ 已完成
1. 市场周期数据加载与统计
2. 回测期间周期段识别
3. 市场基础特征分析
4. 中长期策略框架搭建

### 🚧 进行中
1. 中长期策略分段回测执行
2. 短期策略分段回测执行
3. 策略对比分析

### 📋 待优化
1. 完善错误处理机制
2. 优化短期策略回测接口兼容性
3. 增加可视化分析图表
4. 补充熊市期间的历史数据验证

## 8. 使用建议

### 对于策略开发者
- 重点关注震荡市期间的回撤控制
- 在牛市中适当提高仓位利用率
- 为熊市场景准备防御性参数配置

### 对于投资者
- 理解策略在不同市场环境下的表现差异
- 注意当前回测未覆盖熊市,实盘需谨慎
- 可根据市场状态预判动态调整仓位

## 9. 后续研究方向

1. **扩展时间范围**: 包含 2015-2016、2018 年等熊市阶段进行回测
2. **细分周期**: 将牛熊震荡进一步细分(如初期/中期/末期)
3. **动态适应**: 研究根据市场周期自动切换策略参数
4. **组合策略**: 探索中长期+短期策略的动态配置方案

---

**报告生成时间**: 2025-12-07  
**分析工具版本**: v1.0  
**数据更新至**: 2025-11-27
